/*! aml v1.0.0 xdf email:xudafeng[at]126.com 2013-10-06 14:23:30 */
!function(a){"use strict";function b(){function a(a,b){for(var c in b)a[c]=b[c];return a}for(var b,c=0;c<arguments.length;)b=c?a(b,arguments[c]):arguments[c],c++;return b}function c(a,b){if(a)for(var c in a)"length"!==c&&"item"!==c&&b.call(this,a[c],c);return a}function d(){return v++}function e(a){return function(b){return Object.prototype.toString.call(b)==="[object "+a+"]"}}function f(a){return function(b){return"array"==a||"string"==a?0===b.length:void 0}}function g(){}function h(){}function i(){var a=u.path?u.path:q.href;return a}function j(a){this.id=a,this.pwd=i(),this.init()}function k(){}function l(){var a=p.getElementsByTagName("script");return a[a.length-1].getAttribute("data-init")}if(!a.aml){var m="1.0.0",n="",o=document.head||document.getElementsByTagName("head")[0]||document.documentElement,p=document,q=location,r=".js",s={version:m},t=s.data={},u={},v=0,w=e("String"),x=e("Array");e("Object"),e("Function");var y=e("Undefined"),z=f("array");f("string");var A=function(a){return/\.js$/i.test(a)},B=function(a){return/\.css$/i.test(a)};g.cache={},b(g,{fire:function(a,b){y(this.cache[a])||this.cache[a].call(this,b)},on:function(a,b){this.cache[a]=b},detach:function(a){y(this.cache[a])||delete this.cache[a]}}),b(h,{}),j.prototype={init:function(){this.router()},router:function(){var a=this;B(a.id)?a.getStyle(this.pwd+a.id):a.getScript((A(a.id)?a.id:this.pwd+a.id+r)+"?t="+(u.tag?u.tag:(new Date).valueOf()))},getScript:function(a,b,c){var d=p.createElement("script");return d.src=a,d.async=!0,c&&(d.charset=c),p.addEventListener?d.addEventListener("load",b,!1):d.onreadystatechange=function(){("loaded"==d.readyState||"complete"==d.readyState)&&(d.onreadystatechange=null,b())},o.insertBefore(d,o.firstChild),d},getStyle:function(a,b,c){var d=p.createElement("link");return d.rel="stylesheet",d.href=a,c&&(d.charset=c),d.addEventListener("load",b,!1),o.appendChild(d),d}},b(k,{define:function(a,b,c){var e=a,f=b,h=c;switch(arguments.length){case 1:e="anony"+d(),f=[],h=a;break;case 2:w(e)?(f=[],h=b):x(e)&&(e="anony"+d(),f=a,h=b)}g.fire("define",{id:e,deps:f,constructor:h})},require:function(a){return g.fire("load",a),null},exec:function(a){t[a.id].instance=t[a.id].constructor.apply(this,a.depsMods)||{},g.fire("check",t)},load:function(a){new j(a)},save:function(a){t[a.id]&&t[a.id]!=a.id||(t[a.id]=a,g.fire("check",t))},check:function(a){c(a,function(a){if(!a.instance&&a!=t[a]){var b=[],d=[],e=[];c(a.deps,function(a){t[a]?t[a].instance?d.push(t[a].instance):b.push(t[a]):(e.push(a),t[a]=a)}),z(e)&&z(b)?g.fire("exec",{id:a.id,depsMods:d}):(c(e,function(a){g.fire("load",a)}),g.fire("check",b))}})}}),g.on("define",function(a){g.fire("save",a)}),g.on("check",function(a){k.check(a)}),g.on("exec",function(a){k.exec(a)}),g.on("load",function(a){k.load(a)}),g.on("save",function(a){k.save(a)}),k.define.amd={},a.define=k.define,a.require=k.require,l()&&new j(l()+(A(l())?n:r)),b(s,{config:function(a){b(u,a)}}),a.aml=s}}(this);
/*
//@ sourceMappingURL=1.0.0/bin/aml.map
*/
